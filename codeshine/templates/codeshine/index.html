{% extends 'home/layout.html' %}

{% block title %}
CodeShine
{% endblock %}

{% block body %}
<div class="container">
    <a href="{% url 'departments:index' assignment.In.Department.Code %}">
        << Go Back</a>

            {% if title %}
            <h1>{{ title }}</h1>
            {% endif %}

            {% if assignment.Description %}
            <p>{{ assignment.Description }}</p>
            {% endif %}
</div>
<br>



{% if assignment %}
<div class="container">
    <h2>Details</h2>
    <p>
        This is an assignment titled <u>{{ title }}</u>,
        posted by <u>{{ assignment.By.username|capfirst }}</u> Sir/Madam,
        in page <u>{{ assignment.In.Name }}</u>,
        on <u>{{ assignment.On }}</u>.
        Anyone from <u>{{ assignment.In.Department.Name }}</u> department
        can submit the assignment multiple times and is expected to
        gain at least <u>{{ assignment.passing_points }} points</u>
        or at most <u>{{ assignment.max_points }} points</u>.
    </p>
    <p>
        The <u>Instructions</u> and <u>Getting Started Template</u> are follows.
        When you feel comfortable you can attempt the submit the assignment.
        Feel free to take your time as instructed.
    </p>
    <p>
        Best of luck!
    </p>
</div>
<br>

<div class="container">
    <h2>Submission</h2>
    {% if assignment.open_for_submission == True %}
    <a href="{% url 'codeshine:submit' assignment.In.Code assignment.pk %}">+ Attempt for submission</a>
    {% endif %}
    <br>

    {% if assignment.Instructions %}
    <details>
        <summary>instructions</summary>
        <h2>Instructions</h2>
        <div class="container render-markdown">
            <textarea class="render-markdown">{{ assignment.Instructions }}</textarea>

        </div>
    </details>
    <br>
    {% endif %}

    {% if assignment.GettingStarted_Template %}
    <details>
        <summary>template</summary>
        <h2>Getting Started Template</h2>
        <div class="container render-markdown">
            <textarea class="render-markdown">{{ assignment.GettingStarted_Template }}</textarea>
        </div>
    </details>
    <br>
    {% endif %}

    {% if submissions %}
    <details open>
        <summary>my submission(s)</summary>
        <ol class="ol-attempt">
            {% for submission in submissions %}
            <li class="li-attempt">
                <details>
                    <summary>{{ submission.On }}</summary>
                    <div class="container render-markdown">
                        <textarea class="render-markdown">{{ submission.Assignment }}</textarea>
                    </div>
                </details>
            </li>
            {% endfor %}
        </ol>
    </details>
    {% endif %}
</div>
<br>

{% if comments %}
<div class="container">
    <h2>Evaluation</h2>
    <details open>
        <summary>my evaluation(s)</summary>
        <ol class="ol-attempt">
            {% for submission in submissions %}
            <li class="li-attempt">
                <details>
                    <summary>{{ submission.On }}</summary>
                    {% for comment in comments %}
                    {% if comment.In == submission and comment.By.is_teacher == True %}
                    <div class="container comment-container teacher">
                        <p>By {{ comment.By.username|capfirst }} on {{ comment.On }}</p>
                        <h1 class="theme">{{ comment.Theme }}</h1>
                        <textarea class="render-markdown">{{ comment.Comment }}</textarea>
                    </div>
                    {% endif %}
                    {% endfor %}
                    {% for comment in comments %}
                    {% if comment.In == submission and comment.By.is_teacher == False %}
                    <div class="container comment-container">
                        <p>By {{ comment.By.username|capfirst }} on {{ comment.On }}</p>
                        <h1 class="theme">{{ comment.Theme }}</h1>
                        <textarea class="render-markdown">{{ comment.Comment }}</textarea>
                    </div>
                    {% endif %}
                    {% endfor %}
                </details>
            </li>
            {% endfor %}
        </ol>
    </details>
</div>
<br>
{% endif %}

<br>
{% else %}
<div class="container warning-container">
    <h1>Warning</h1>
    <p>No Assignment Details Available</p>
</div>
<br>
{% endif %}
{% endblock %}